<!DOCTYPE html>
<html>
  <head>
    <title>Financial Report</title>
    <style>
      body {
        font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
        font-size: 0.5em;
      }
      table {
        border-collapse: collapse;
        width: 100%;
      }
      th,
      td {
        border: 1px solid black;
        padding: 8px;
        text-align: left;
      }
      th {
        background-color: #17d1a3ff;
        position: sticky;
        top: 0;
      }
      td.currency {
        text-align: right;
      }
      tr:nth-child(even) {
        background-color: #f2f2f2;
      }
      .null-value {
        color: #999;
        font-style: italic;
      }
    </style>
  </head>
  <body>
    <table border="1">
      <thead>
        <tr>
          <th>VAMC ID</th>
          <th>Date</th>
          <th>Department</th>
          <th>Vendor</th>
          <th>Account</th>
          <th>Contract #</th>
          <th>Requestor</th>
          <th>Approver</th>
          <th>Committed Estimated Cost</th>
          <th>Transaction Amount</th>
        </tr>
      </thead>
      <tbody id="reportTableBody">
        <!-- Data will be inserted here by JavaScript -->
      </tbody>
    </table>

    <script>
      // Helper function to format currency
      function formatCurrency(amount) {
        if (amount === null || amount === undefined || amount === 0)
          return "$0.00";
        return (
          "$" +
          parseFloat(amount).toLocaleString("en-US", {
            minimumFractionDigits: 2,
            maximumFractionDigits: 2,
          })
        );
      }

      // Load data from sessionStorage
      const dataJson = sessionStorage.getItem("financialReportData");

      if (dataJson) {
        const data = JSON.parse(dataJson);
        const tbody = document.getElementById("reportTableBody");

        data.forEach((row) => {
          const tr = document.createElement("tr");
          tr.innerHTML = `
          <td>${
            row.station_number || '<span class="null-value">N/A</span>'
          }</td>
          <td>${
            row.date_of_request
              ? new Date(row.date_of_request).toLocaleDateString("en-US")
              : '<span class="null-value">N/A</span>'
          }</td>
          <td>${
            row.requesting_service || '<span class="null-value">N/A</span>'
          }</td>
          <td>${row.vendor || '<span class="null-value">N/A</span>'}</td>
          <td>${row.cost_center || '<span class="null-value">N/A</span>'}</td>
          <td>${
            row.purchase_order_obligation_no ||
            '<span class="null-value">N/A</span>'
          }</td>
          <td>${
            row.originator_of_request || '<span class="null-value">N/A</span>'
          }</td>
          <td>${
            row.approving_official || '<span class="null-value">N/A</span>'
          }</td>
          <td class="currency">${formatCurrency(
            row.Committed_Estimated_Cost
          )}</td>
          <td class="currency">${formatCurrency(row.Transaction_Amount)}</td>
        `;
          tbody.appendChild(tr);
        });

        // Clear the data from sessionStorage after use
        sessionStorage.removeItem("financialReportData");
      } else {
        document.getElementById("reportTableBody").innerHTML =
          '<tr><td colspan="10">No data available</td></tr>';
      }
    </script>
  </body>
</html>
